{
    "test_ref": {
        "type": "assert_equal",
        "args": {
            "species": "taeniopygia_guttata",
            "which": "all",
            "release": 110,
            "ftp": false
        },
        "expected_result": {
            "taeniopygia_guttata": {
                "transcriptome_cdna": {
                    "ftp": "http://ftp.ensembl.org/pub/release-110/fasta/taeniopygia_guttata/cdna/Taeniopygia_guttata.bTaeGut1_v1.p.cdna.all.fa.gz",
                    "ensembl_release": 110,
                    "release_date": "2023-04-21",
                    "release_time": "23:40",
                    "bytes": "26M"
                },
                "genome_dna": {
                    "ftp": "http://ftp.ensembl.org/pub/release-110/fasta/taeniopygia_guttata/dna/Taeniopygia_guttata.bTaeGut1_v1.p.dna.toplevel.fa.gz",
                    "ensembl_release": 110,
                    "release_date": "2023-04-21",
                    "release_time": "17:16",
                    "bytes": "304M"
                },
                "annotation_gtf": {
                    "ftp": "http://ftp.ensembl.org/pub/release-110/gtf/taeniopygia_guttata/Taeniopygia_guttata.bTaeGut1_v1.p.110.gtf.gz",
                    "ensembl_release": 110,
                    "release_date": "2023-04-24",
                    "release_time": "15:16",
                    "bytes": "13M"
                },
                "coding_seq_cds": {
                    "ftp": "http://ftp.ensembl.org/pub/release-110/fasta/taeniopygia_guttata/cds/Taeniopygia_guttata.bTaeGut1_v1.p.cds.all.fa.gz",
                    "ensembl_release": 110,
                    "release_date": "2023-04-21",
                    "release_time": "23:40",
                    "bytes": "13M"
                },
                "non-coding_seq_ncRNA": {
                    "ftp": "http://ftp.ensembl.org/pub/release-110/fasta/taeniopygia_guttata/ncrna/Taeniopygia_guttata.bTaeGut1_v1.p.ncrna.fa.gz",
                    "ensembl_release": 110,
                    "release_date": "2023-04-22",
                    "release_time": "00:09",
                    "bytes": "5.0M"
                },
                "protein_translation_pep": {
                    "ftp": "http://ftp.ensembl.org/pub/release-110/fasta/taeniopygia_guttata/pep/Taeniopygia_guttata.bTaeGut1_v1.p.pep.all.fa.gz",
                    "ensembl_release": 110,
                    "release_date": "2023-04-21",
                    "release_time": "23:40",
                    "bytes": "8.3M"
                }
            }
        }
    },
    "test_ref_which": {
        "type": "assert_equal",
        "args": {
            "species": "taeniopygia_guttata",
            "which": [
                "gtf",
                "dna",
                "pep"
            ],
            "release": 108,
            "ftp": false
        },
        "expected_result": {
            "taeniopygia_guttata": {
                "annotation_gtf": {
                    "ftp": "http://ftp.ensembl.org/pub/release-108/gtf/taeniopygia_guttata/Taeniopygia_guttata.bTaeGut1_v1.p.108.gtf.gz",
                    "ensembl_release": 108,
                    "release_date": "2022-07-29",
                    "release_time": "15:23",
                    "bytes": "13M"
                },
                "genome_dna": {
                    "ftp": "http://ftp.ensembl.org/pub/release-108/fasta/taeniopygia_guttata/dna/Taeniopygia_guttata.bTaeGut1_v1.p.dna.toplevel.fa.gz",
                    "ensembl_release": 108,
                    "release_date": "2022-09-02",
                    "release_time": "14:59",
                    "bytes": "304M"
                },
                "protein_translation_pep": {
                    "ftp": "http://ftp.ensembl.org/pub/release-108/fasta/taeniopygia_guttata/pep/Taeniopygia_guttata.bTaeGut1_v1.p.pep.all.fa.gz",
                    "ensembl_release": 108,
                    "release_date": "2022-07-25",
                    "release_time": "19:00",
                    "bytes": "8.3M"
                }
            }
        }
    },
    "test_ref_rel": {
        "type": "assert_equal",
        "args": {
            "species": "taeniopygia_guttata",
            "which": [
                "cdna",
                "dna",
                "cds"
            ],
            "release": 76,
            "ftp": false
        },
        "expected_result": {
            "taeniopygia_guttata": {
                "transcriptome_cdna": {
                    "ftp": "http://ftp.ensembl.org/pub/release-76/fasta/taeniopygia_guttata/cdna/Taeniopygia_guttata.taeGut3.2.4.cdna.all.fa.gz",
                    "ensembl_release": 76,
                    "release_date": "2014-07-19",
                    "release_time": "11:53",
                    "bytes": "8.1M"
                },
                "genome_dna": {
                    "ftp": "http://ftp.ensembl.org/pub/release-76/fasta/taeniopygia_guttata/dna/Taeniopygia_guttata.taeGut3.2.4.dna.toplevel.fa.gz",
                    "ensembl_release": 76,
                    "release_date": "2014-07-19",
                    "release_time": "02:16",
                    "bytes": "352M"
                },
                "coding_seq_cds": {
                    "ftp": "http://ftp.ensembl.org/pub/release-76/fasta/taeniopygia_guttata/cds/Taeniopygia_guttata.taeGut3.2.4.cds.all.fa.gz",
                    "ensembl_release": 76,
                    "release_date": "2014-07-19",
                    "release_time": "11:53",
                    "bytes": "7.6M"
                }
            }
        }
    },
    "test_ref_rel_ftp": {
        "type": "assert_equal",
        "args": {
            "species": "taeniopygia_guttata",
            "which": [
                "gtf",
                "dna",
                "pep"
            ],
            "release": 76,
            "ftp": true
        },
        "expected_result": [
            "http://ftp.ensembl.org/pub/release-76/gtf/taeniopygia_guttata/Taeniopygia_guttata.taeGut3.2.4.76.gtf.gz",
            "http://ftp.ensembl.org/pub/release-76/fasta/taeniopygia_guttata/dna/Taeniopygia_guttata.taeGut3.2.4.dna.toplevel.fa.gz",
            "http://ftp.ensembl.org/pub/release-76/fasta/taeniopygia_guttata/pep/Taeniopygia_guttata.taeGut3.2.4.pep.all.fa.gz"
        ]
    },
    "test_ref_ftp": {
        "type": "assert_equal",
        "args": {
            "species": "taeniopygia_guttata",
            "which": [
                "dna",
                "ncrna",
                "gtf"
            ],
            "release": 110,
            "ftp": true
        },
        "expected_result": [
            "http://ftp.ensembl.org/pub/release-110/fasta/taeniopygia_guttata/dna/Taeniopygia_guttata.bTaeGut1_v1.p.dna.toplevel.fa.gz",
            "http://ftp.ensembl.org/pub/release-110/fasta/taeniopygia_guttata/ncrna/Taeniopygia_guttata.bTaeGut1_v1.p.ncrna.fa.gz",
            "http://ftp.ensembl.org/pub/release-110/gtf/taeniopygia_guttata/Taeniopygia_guttata.bTaeGut1_v1.p.110.gtf.gz"
        ]
    },
    "test_ref_plant": {
        "type": "assert_equal",
        "args": {
            "species": "actinidia_chinensis",
            "which": "all",
            "release": 53,
            "ftp": false
        },
        "expected_result": {
            "actinidia_chinensis": {
                "transcriptome_cdna": {
                    "ftp": "http://ftp.ensemblgenomes.org/pub/release-53/plants/fasta/actinidia_chinensis/cdna/Actinidia_chinensis.Red5_PS1_1.69.0.cdna.all.fa.gz",
                    "ensembl_release": 53,
                    "release_date": "2022-02-15",
                    "release_time": "12:53",
                    "bytes": "24M"
                },
                "genome_dna": {
                    "ftp": "http://ftp.ensemblgenomes.org/pub/release-53/plants/fasta/actinidia_chinensis/dna/Actinidia_chinensis.Red5_PS1_1.69.0.dna.toplevel.fa.gz",
                    "ensembl_release": 53,
                    "release_date": "2022-02-21",
                    "release_time": "10:52",
                    "bytes": "155M"
                },
                "annotation_gtf": {
                    "ftp": "http://ftp.ensemblgenomes.org/pub/release-53/plants/gtf/actinidia_chinensis/Actinidia_chinensis.Red5_PS1_1.69.0.53.gtf.gz",
                    "ensembl_release": 53,
                    "release_date": "2022-02-17",
                    "release_time": "09:13",
                    "bytes": "6.7M"
                },
                "coding_seq_cds": {
                    "ftp": "http://ftp.ensemblgenomes.org/pub/release-53/plants/fasta/actinidia_chinensis/cds/Actinidia_chinensis.Red5_PS1_1.69.0.cds.all.fa.gz",
                    "ensembl_release": 53,
                    "release_date": "2022-02-15",
                    "release_time": "12:53",
                    "bytes": "14M"
                },
                "non-coding_seq_ncRNA": {
                    "ftp": "",
                    "ensembl_release": 53,
                    "release_date": "",
                    "release_time": "",
                    "bytes": ""
                },
                "protein_translation_pep": {
                    "ftp": "http://ftp.ensemblgenomes.org/pub/release-53/plants/fasta/actinidia_chinensis/pep/Actinidia_chinensis.Red5_PS1_1.69.0.pep.all.fa.gz",
                    "ensembl_release": 53,
                    "release_date": "2022-02-15",
                    "release_time": "12:53",
                    "bytes": "9.7M"
                }
            }
        }
    },
    "test_ref_which_plant": {
        "type": "assert_equal",
        "args": {
            "species": "aegilops_tauschii",
            "which": [
                "gtf",
                "dna",
                "pep"
            ],
            "release": 53,
            "ftp": false
        },
        "expected_result": {
            "aegilops_tauschii": {
                "annotation_gtf": {
                    "ftp": "http://ftp.ensemblgenomes.org/pub/release-53/plants/gtf/aegilops_tauschii/Aegilops_tauschii.Aet_v4.0.53.gtf.gz",
                    "ensembl_release": 53,
                    "release_date": "2022-02-27",
                    "release_time": "00:58",
                    "bytes": "40M"
                },
                "genome_dna": {
                    "ftp": "http://ftp.ensemblgenomes.org/pub/release-53/plants/fasta/aegilops_tauschii/dna/Aegilops_tauschii.Aet_v4.0.dna.toplevel.fa.gz",
                    "ensembl_release": 53,
                    "release_date": "2022-02-21",
                    "release_time": "12:17",
                    "bytes": "1.1G"
                },
                "protein_translation_pep": {
                    "ftp": "http://ftp.ensemblgenomes.org/pub/release-53/plants/fasta/aegilops_tauschii/pep/Aegilops_tauschii.Aet_v4.0.pep.all.fa.gz",
                    "ensembl_release": 53,
                    "release_date": "2022-02-17",
                    "release_time": "06:03",
                    "bytes": "20M"
                }
            }
        }
    },
    "test_ref_rel_protist": {
        "type": "assert_equal",
        "args": {
            "species": "entamoeba_histolytica",
            "which": [
                "cdna",
                "dna",
                "cds"
            ],
            "release": 48,
            "ftp": false
        },
        "expected_result": {
            "entamoeba_histolytica": {
                "transcriptome_cdna": {
                    "ftp": "http://ftp.ensemblgenomes.org/pub/release-48/protists/fasta/entamoeba_histolytica/cdna/Entamoeba_histolytica.JCVI-ESG2-1.0.cdna.all.fa.gz",
                    "ensembl_release": 48,
                    "release_date": "2020-07-11",
                    "release_time": "00:52",
                    "bytes": "3.2M"
                },
                "genome_dna": {
                    "ftp": "http://ftp.ensemblgenomes.org/pub/release-48/protists/fasta/entamoeba_histolytica/dna/Entamoeba_histolytica.JCVI-ESG2-1.0.dna.toplevel.fa.gz",
                    "ensembl_release": 48,
                    "release_date": "2020-07-10",
                    "release_time": "17:55",
                    "bytes": "5.8M"
                },
                "coding_seq_cds": {
                    "ftp": "http://ftp.ensemblgenomes.org/pub/release-48/protists/fasta/entamoeba_histolytica/cds/Entamoeba_histolytica.JCVI-ESG2-1.0.cds.all.fa.gz",
                    "ensembl_release": 48,
                    "release_date": "2020-07-11",
                    "release_time": "00:52",
                    "bytes": "3.1M"
                }
            }
        }
    },
    "test_ref_rel_ftp_octopus": {
        "type": "assert_equal",
        "args": {
            "species": "octopus_bimaculoides",
            "which": [
                "gtf",
                "dna",
                "pep"
            ],
            "release": 51,
            "ftp": true
        },
        "expected_result": [
            "http://ftp.ensemblgenomes.org/pub/release-51/metazoa/gtf/octopus_bimaculoides/Octopus_bimaculoides.PRJNA270931.51.gtf.gz",
            "http://ftp.ensemblgenomes.org/pub/release-51/metazoa/fasta/octopus_bimaculoides/dna/Octopus_bimaculoides.PRJNA270931.dna.toplevel.fa.gz",
            "http://ftp.ensemblgenomes.org/pub/release-51/metazoa/fasta/octopus_bimaculoides/pep/Octopus_bimaculoides.PRJNA270931.pep.all.fa.gz"
        ]
    },
    "test_ref_list": {
        "type": "assert_equal",
        "args": {
            "species": null,
            "release": 100,
            "list_species": true
        },
        "expected_result": [
            "acanthochromis_polyacanthus",
            "accipiter_nisus",
            "ailuropoda_melanoleuca",
            "amazona_collaria",
            "amphilophus_citrinellus",
            "amphiprion_ocellaris",
            "amphiprion_percula",
            "anabas_testudineus",
            "anas_platyrhynchos",
            "anas_platyrhynchos_platyrhynchos",
            "anolis_carolinensis",
            "anser_brachyrhynchus",
            "anser_cygnoides",
            "aotus_nancymaae",
            "apteryx_haastii",
            "apteryx_owenii",
            "apteryx_rowi",
            "aquila_chrysaetos_chrysaetos",
            "astatotilapia_calliptera",
            "astyanax_mexicanus",
            "astyanax_mexicanus_pachon",
            "athene_cunicularia",
            "betta_splendens",
            "bison_bison_bison",
            "bos_grunniens",
            "bos_indicus_hybrid",
            "bos_mutus",
            "bos_taurus",
            "bos_taurus_hybrid",
            "caenorhabditis_elegans",
            "calidris_pugnax",
            "calidris_pygmaea",
            "callithrix_jacchus",
            "callorhinchus_milii",
            "camarhynchus_parvulus",
            "camelus_dromedarius",
            "canis_lupus_dingo",
            "canis_lupus_familiaris",
            "canis_lupus_familiarisbasenji",
            "canis_lupus_familiarisgreatdane",
            "capra_hircus",
            "carassius_auratus",
            "carlito_syrichta",
            "castor_canadensis",
            "catagonus_wagneri",
            "cavia_aperea",
            "cavia_porcellus",
            "cebus_capucinus",
            "cercocebus_atys",
            "chelonoidis_abingdonii",
            "chelydra_serpentina",
            "chinchilla_lanigera",
            "chlorocebus_sabaeus",
            "choloepus_hoffmanni",
            "chrysemys_picta_bellii",
            "chrysolophus_pictus",
            "ciona_intestinalis",
            "ciona_savignyi",
            "clupea_harengus",
            "colobus_angolensis_palliatus",
            "cottoperca_gobio",
            "coturnix_japonica",
            "cricetulus_griseus_chok1gshd",
            "cricetulus_griseus_crigri",
            "cricetulus_griseus_picr",
            "crocodylus_porosus",
            "cyanistes_caeruleus",
            "cynoglossus_semilaevis",
            "cyprinodon_variegatus",
            "cyprinus_carpio",
            "cyprinus_carpio_germanmirror",
            "cyprinus_carpio_hebaored",
            "cyprinus_carpio_huanghe",
            "danio_rerio",
            "dasypus_novemcinctus",
            "delphinapterus_leucas",
            "denticeps_clupeoides",
            "dicentrarchus_labrax",
            "dipodomys_ordii",
            "dromaius_novaehollandiae",
            "drosophila_melanogaster",
            "echeneis_naucrates",
            "echinops_telfairi",
            "electrophorus_electricus",
            "eptatretus_burgeri",
            "equus_asinus_asinus",
            "equus_caballus",
            "erinaceus_europaeus",
            "erpetoichthys_calabaricus",
            "erythrura_gouldiae",
            "esox_lucius",
            "felis_catus",
            "ficedula_albicollis",
            "fukomys_damarensis",
            "fundulus_heteroclitus",
            "gadus_morhua",
            "gallus_gallus",
            "gambusia_affinis",
            "gasterosteus_aculeatus",
            "geospiza_fortis",
            "gopherus_agassizii",
            "gopherus_evgoodei",
            "gorilla_gorilla",
            "gouania_willdenowi",
            "haplochromis_burtoni",
            "heterocephalus_glaber_female",
            "heterocephalus_glaber_male",
            "hippocampus_comes",
            "homo_sapiens",
            "hucho_hucho",
            "ictalurus_punctatus",
            "ictidomys_tridecemlineatus",
            "jaculus_jaculus",
            "junco_hyemalis",
            "kryptolebias_marmoratus",
            "labrus_bergylta",
            "larimichthys_crocea",
            "lates_calcarifer",
            "laticauda_laticaudata",
            "latimeria_chalumnae",
            "lepidothrix_coronata",
            "lepisosteus_oculatus",
            "lonchura_striata_domestica",
            "loxodonta_africana",
            "lynx_canadensis",
            "macaca_fascicularis",
            "macaca_mulatta",
            "macaca_nemestrina",
            "manacus_vitellinus",
            "mandrillus_leucophaeus",
            "marmota_marmota_marmota",
            "mastacembelus_armatus",
            "maylandia_zebra",
            "meleagris_gallopavo",
            "melopsittacus_undulatus",
            "meriones_unguiculatus",
            "mesocricetus_auratus",
            "microcebus_murinus",
            "microtus_ochrogaster",
            "mola_mola",
            "monodelphis_domestica",
            "monopterus_albus",
            "moschus_moschiferus",
            "mus_caroli",
            "mus_musculus",
            "mus_musculus_129s1svimj",
            "mus_musculus_aj",
            "mus_musculus_akrj",
            "mus_musculus_balbcj",
            "mus_musculus_c3hhej",
            "mus_musculus_c57bl6nj",
            "mus_musculus_casteij",
            "mus_musculus_cbaj",
            "mus_musculus_dba2j",
            "mus_musculus_fvbnj",
            "mus_musculus_lpj",
            "mus_musculus_nodshiltj",
            "mus_musculus_nzohlltj",
            "mus_musculus_pwkphj",
            "mus_musculus_wsbeij",
            "mus_pahari",
            "mus_spicilegus",
            "mus_spretus",
            "mustela_putorius_furo",
            "myotis_lucifugus",
            "myripristis_murdjan",
            "nannospalax_galili",
            "neogobius_melanostomus",
            "neolamprologus_brichardi",
            "neovison_vison",
            "nomascus_leucogenys",
            "notamacropus_eugenii",
            "notechis_scutatus",
            "nothoprocta_perdicaria",
            "numida_meleagris",
            "ochotona_princeps",
            "octodon_degus",
            "oncorhynchus_mykiss",
            "oncorhynchus_tshawytscha",
            "oreochromis_aureus",
            "oreochromis_niloticus",
            "ornithorhynchus_anatinus",
            "oryctolagus_cuniculus",
            "oryzias_javanicus",
            "oryzias_latipes",
            "oryzias_latipes_hni",
            "oryzias_latipes_hsok",
            "oryzias_melastigma",
            "oryzias_sinensis",
            "otolemur_garnettii",
            "ovis_aries",
            "pan_paniscus",
            "pan_troglodytes",
            "panthera_leo",
            "panthera_pardus",
            "panthera_tigris_altaica",
            "papio_anubis",
            "parambassis_ranga",
            "paramormyrops_kingsleyae",
            "parus_major",
            "pavo_cristatus",
            "pelodiscus_sinensis",
            "pelusios_castaneus",
            "periophthalmus_magnuspinnatus",
            "peromyscus_maniculatus_bairdii",
            "petromyzon_marinus",
            "phascolarctos_cinereus",
            "phasianus_colchicus",
            "physeter_catodon",
            "piliocolobus_tephrosceles",
            "podarcis_muralis",
            "poecilia_formosa",
            "poecilia_latipinna",
            "poecilia_mexicana",
            "poecilia_reticulata",
            "pogona_vitticeps",
            "pongo_abelii",
            "procavia_capensis",
            "prolemur_simus",
            "propithecus_coquereli",
            "pseudonaja_textilis",
            "pteropus_vampyrus",
            "pundamilia_nyererei",
            "pygocentrus_nattereri",
            "rattus_norvegicus",
            "rhinolophus_ferrumequinum",
            "rhinopithecus_bieti",
            "rhinopithecus_roxellana",
            "saccharomyces_cerevisiae",
            "saimiri_boliviensis_boliviensis",
            "salarias_fasciatus",
            "salmo_salar",
            "salmo_trutta",
            "salvator_merianae",
            "sarcophilus_harrisii",
            "scleropages_formosus",
            "scophthalmus_maximus",
            "serinus_canaria",
            "seriola_dumerili",
            "seriola_lalandi_dorsalis",
            "sinocyclocheilus_anshuiensis",
            "sinocyclocheilus_grahami",
            "sinocyclocheilus_rhinocerous",
            "sorex_araneus",
            "sparus_aurata",
            "spermophilus_dauricus",
            "sphaeramia_orbicularis",
            "sphenodon_punctatus",
            "stachyris_ruficeps",
            "stegastes_partitus",
            "strigops_habroptila",
            "struthio_camelus_australis",
            "suricata_suricatta",
            "sus_scrofa",
            "sus_scrofa_bamei",
            "sus_scrofa_berkshire",
            "sus_scrofa_hampshire",
            "sus_scrofa_jinhua",
            "sus_scrofa_landrace",
            "sus_scrofa_largewhite",
            "sus_scrofa_meishan",
            "sus_scrofa_pietrain",
            "sus_scrofa_rongchang",
            "sus_scrofa_tibetan",
            "sus_scrofa_usmarc",
            "sus_scrofa_wuzhishan",
            "taeniopygia_guttata",
            "takifugu_rubripes",
            "terrapene_carolina_triunguis",
            "tetraodon_nigroviridis",
            "theropithecus_gelada",
            "tupaia_belangeri",
            "tursiops_truncatus",
            "urocitellus_parryii",
            "ursus_americanus",
            "ursus_maritimus",
            "ursus_thibetanus_thibetanus",
            "varanus_komodoensis",
            "vicugna_pacos",
            "vombatus_ursinus",
            "vulpes_vulpes",
            "xenopus_tropicalis",
            "xiphophorus_couchianus",
            "xiphophorus_maculatus",
            "zonotrichia_albicollis",
            "zosterops_lateralis_melanops"
        ]
    },
    "test_ref_bad_species": {
        "type": "error",
        "args": {
            "species": "banana",
            "which": [
                "cdna",
                "dna",
                "cds"
            ],
            "release": 76,
            "ftp": false
        },
        "expected_result": "RuntimeError"
    },
    "test_ref_bad_which": {
        "type": "error",
        "args": {
            "species": "taeniopygia_guttata",
            "which": [
                "sneeze"
            ],
            "release": 105,
            "ftp": false
        },
        "expected_result": "ValueError"
    },
    "test_ref_bad_rel": {
        "type": "error",
        "args": {
            "species": "taeniopygia_guttata",
            "which": [
                "gtf"
            ],
            "release": 2000,
            "ftp": false
        },
        "expected_result": "RuntimeError"
    }
}